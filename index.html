<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OMNISCIENTRIX MAP — Life & Earth-Likeness Finder</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* === GLOBAL STYLE === */
html, body {
  margin: 0; padding: 0;
  overflow: hidden;
  background: #000;
  font-family: Arial, sans-serif;
  color: #00aaff;
}

/* === UI PANEL === */
#ui {
  position: fixed;
  top: 10px; left: 10px;
  width: 300px;
  background: rgba(0,0,0,0.55);
  padding: 15px;
  border-radius: 10px;
  border: 1px solid #00aaff55;
  backdrop-filter: blur(6px);
}

#ui h1 {
  font-size: 20px; margin: 0 0 10px 0;
  color: #00caff;
}

#ui h2 {
  font-size: 14px; margin: 10px 0 3px 0;
  color: #00d0ff;
}

#ui p { font-size: 12px; margin: 3px 0; }

#planet-info {
  margin-top: 10px;
  padding: 10px;
  border: 1px solid #005577;
  border-radius: 6px;
}

/* === FOOTER === */
#footer {
  position: fixed;
  bottom: 10px; left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  color: #0099ff;
  opacity: 0.7;
}
</style>
</head>

<body>

<div id="ui">
  <h1>OMNISCIENTRIX MAP</h1>
  <h2>Life-Finder Controls</h2>

  <p><b>Click any glowing planet-node</b> to inspect life probability.</p>

  <h2>Current Selection:</h2>
  <div id="planet-info">
    <p>No planet selected.</p>
  </div>
</div>

<canvas id="universe"></canvas>

<div id="footer">
  © 2025 Cornelius Aurelius · <a href="#" style="color:#00aaff;">The Peace License</a>
</div>

<script>
/* ============================================================
   OMNISCIENTRIX MAP vΩ — Single-File Universe Engine
   Complete procedural galaxy + habitability scoring built-in
   ============================================================ */

/* === Canvas Setup === */
const canvas = document.getElementById("universe");
const ctx = canvas.getContext("webgl2", { antialias: true });

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize(); window.onresize = resize;

/* ============================================================
   PROCEDURAL GALAXY GENERATOR
   Creates ~8,000 procedural stars + ~300 procedural exoplanets
   ============================================================ */

const STAR_COUNT = 8000;
const PLANET_COUNT = 300;

let stars = [];
let planets = [];

/* === Create Stars === */
for (let i = 0; i < STAR_COUNT; i++) {
  stars.push({
    x: (Math.random() - 0.5) * 5000,
    y: (Math.random() - 0.5) * 5000,
    z: (Math.random() - 0.5) * 5000,
    brightness: Math.random()
  });
}

/* === Create Procedural Exoplanets === */
for (let i = 0; i < PLANET_COUNT; i++) {

  // Position planets near one of the stars
  const host = stars[Math.floor(Math.random() * STAR_COUNT)];

  // Random orbital distance
  const dist = 5 + Math.random() * 50;

  planets.push({
    name: `PX-${1000 + i}`,
    x: host.x + (Math.random() - 0.5) * dist,
    y: host.y + (Math.random() - 0.5) * dist,
    z: host.z + (Math.random() - 0.5) * dist,

    // Realistic astrophysics values
    radius: 0.5 + Math.random() * 2.5,          // Earth radii
    temp: 150 + Math.random() * 400,            // Kelvin
    flux: 0.1 + Math.random() * 2.5,            // Insolation
    water: Math.random(),                       // Probability
    atmosphere: Math.random(),                  // Strength
    ch4: Math.random() * 0.02,                  // Methane %
    o2: Math.random() * 0.21,                   // Oxygen %
    co2: Math.random() * 0.10,                  // CO2 %
    haze: Math.random(),

    // Will be computed later
    iels: 0,
    lifeScore: 0,
    esi: 0
  });
}

/* ============================================================
   EARTH SIMILARITY INDEX (ESI)
   ============================================================ */
function computeESI(p) {
  const r = Math.abs((p.radius - 1) / (p.radius + 1));
  const t = Math.abs((p.temp - 288) / (p.temp + 288));
  return 1 - (r * 0.5 + t * 0.5);
}

/* ============================================================
   HABITABILITY: Informational Earth-Likeness Score (IELS)
   (Simplified but scientifically valid structure)
   ============================================================ */
function computeIELS(p) {
  let tempTerm = Math.exp(-Math.abs(p.temp - 288) / 80);
  let waterTerm = p.water;
  let atmoTerm = p.atmosphere;
  let fluxTerm = Math.exp(-Math.abs(p.flux - 1));

  return (tempTerm * 0.35 + waterTerm * 0.35 +
          atmoTerm * 0.15 + fluxTerm * 0.15);
}

/* ============================================================
   LIFE PROBABILITY: PLife (Composite)
   Using atmospheric disequilibrium + IELS + ESI
   ============================================================ */
function computeLife(p) {
  const diseq = Math.abs(p.o2 * p.ch4) > 0.001 ? 1 : 0; // Biosignature flag

  return (
    p.iels * 0.6 +
    p.esi * 0.3 +
    diseq * 0.1
  );
}

/* ============================================================
   COMPUTE ALL SCORES
   ============================================================ */
for (let p of planets) {
  p.esi = computeESI(p);
  p.iels = computeIELS(p);
  p.lifeScore = computeLife(p);
}

/* ============================================================
   SIMPLE 3D CAMERA  
   ============================================================ */
let cam = { x: 0, y: 0, z: -600, rx: 0, ry: 0 };

document.addEventListener("mousemove", e => {
  cam.ry = (e.clientX / window.innerWidth - 0.5) * 2;
  cam.rx = (e.clientY / window.innerHeight - 0.5) * 2;
});

/* ============================================================
   RENDER LOOP (2D projection)
   ============================================================ */
const gl = canvas.getContext("2d");

function render() {
  gl.fillStyle = "black";
  gl.fillRect(0,0,canvas.width,canvas.height);

  // Draw stars
  for (let s of stars) {
    const sx = (s.x - cam.x);
    const sy = (s.y - cam.y);
    const sz = (s.z - cam.z);

    const scale = 300 / (sz + 500);

    const x2d = sx * scale + canvas.width / 2;
    const y2d = sy * scale + canvas.height / 2;

    gl.fillStyle = `rgba(0,150,255,${s.brightness})`;
    gl.fillRect(x2d, y2d, 2,2);
  }

  // Draw planets
  for (let p of planets) {
    const sx = (p.x - cam.x);
    const sy = (p.y - cam.y);
    const sz = (p.z - cam.z);

    const scale = 400 / (sz + 500);

    const x2d = sx * scale + canvas.width / 2;
    const y2d = sy * scale + canvas.height / 2;

    const c = Math.min(1, p.lifeScore);

    gl.fillStyle = `rgba(${(1-c)*0},${c*255},255,1)`;

    gl.beginPath();
    gl.arc(x2d, y2d, 3 + c*3, 0, Math.PI*2);
    gl.fill();

    // Click detection
    p.screen = {x: x2d, y: y2d};
  }

  requestAnimationFrame(render);
}
render();

/* ============================================================
   CLICK → Inspect Planet
   ============================================================ */
canvas.addEventListener("click", e => {
  const mx = e.clientX, my = e.clientY;

  for (let p of planets) {
    if (!p.screen) continue;
    if (Math.hypot(mx - p.screen.x, my - p.screen.y) < 8) {
      showPlanet(p);
      break;
    }
  }
});

function showPlanet(p) {
  document.getElementById("planet-info").innerHTML = `
    <b>${p.name}</b><br>
    Radius: ${p.radius.toFixed(2)} R⊕<br>
    Temp: ${p.temp.toFixed(0)} K<br>
    ESI: ${(p.esi*100).toFixed(1)}%<br>
    IELS: ${(p.iels*100).toFixed(1)}%<br>
    Life Score: ${(p.lifeScore*100).toFixed(1)}%<br>
    Water Probability: ${(p.water*100).toFixed(1)}%<br>
    Atmosphere Strength: ${(p.atmosphere*100).toFixed(1)}%<br>
    O₂: ${(p.o2*100).toFixed(2)}%<br>
    CH₄: ${(p.ch4*100).toFixed(2)}%<br>
    CO₂: ${(p.co2*100).toFixed(2)}%
  `;
}
</script>

</body>
</html>
